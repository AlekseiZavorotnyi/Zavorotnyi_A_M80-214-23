if [ $# -ne 3 ]
then
    echo "Incorrect test usage. Expected <exec file with args> <return code> <file with output messages>"
    exit 1
fi

if [ ! -f $3 ]; then
    echo "Output file with messages not found"
    exit 3
fi

ret=$2

if (( $ret < 0 ))
then
    ret=$(( 256 + $ret ))
fi

if [[ $($(pwd)/$1) = $(cat $3) && $? = $ret ]]
then
    exit 0
else
    exit 2
fi